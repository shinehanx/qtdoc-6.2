<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- android-building.qdoc -->
  <title>Qt for Android - Building from Source | Qt 6.2</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li><a href="index.html">Qt 6.2</a></li>
<li>Qt for Android - Building from Source</li>
<li id="buildversion">Qt 6.2.3 Reference Documentation</li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
  <link rel="prev" href="android-getting-started.html" />
  <link rel="next" href="porting-to-android.html" />
<p class="naviNextPrevious headerNavi">
<a class="prevPage" href="android-getting-started.html">Getting Started with Qt for Android</a>
<span class="naviSeparator">  &#9702;  </span>
<a class="nextPage" href="porting-to-android.html">Porting to Android</a>
</p>
<div class="sidebar">
<div class="toc">
<h3 id="toc">Contents</h3>
<ul>
<li class="level1"><a href="#building-on-linux">Building on Linux</a></li>
<li class="level2"><a href="#prepare-the-build-environment">Prepare the Build Environment</a></li>
<li class="level1"><a href="#building-qt-for-android">Building Qt for Android</a></li>
<li class="level1"><a href="#building-on-linux">Building on Linux</a></li>
<li class="level2"><a href="#unpacking-the-archive">Unpacking the Archive</a></li>
<li class="level2"><a href="#configuring-and-building-on-linux">Configuring and Building on Linux</a></li>
<li class="level1"><a href="#building-on-windows">Building on Windows</a></li>
<li class="level2"><a href="#preparing-the-build-environment">Preparing the Build Environment</a></li>
<li class="level2"><a href="#configuring-and-building-on-windows">Configuring and Building on Windows</a></li>
<li class="level1"><a href="#advanced-build-arguments">Advanced Build Arguments</a></li>
<li class="level2"><a href="#building-separate-modules">Building Separate Modules</a></li>
<li class="level1"><a href="#building-user-projects">Building User Projects</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Qt for Android - Building from Source</h1>
<!-- $$$android-building.html-description -->
<div class="descr" id="details">
<p>Qt for Android has some requirements that you are recommended to know before going through this guide. Accomplish the tasks in <a href="android-getting-started.html">Getting Started with Qt for Android</a> first.</p>
<p>You can download the Qt sources from the <a href="https://www.qt.io/download">Qt Downloads</a> page, or follow the wiki guide for <a href="https://wiki.qt.io/Building_Qt_5_from_Git#Getting_the_source_code">Getting the source code</a>.</p>
<h2 id="building-on-linux">Building on Linux</h2>
<h3 id="prepare-the-build-environment">Prepare the Build Environment</h3>
<p>First, install the Android SDK in one of two ways:</p>
<ul>
<li><a href="android-building.html#using-manual-installation">Using Manual Installation</a></li>
<li><a href="android-building.html#using-qt-creator">Using Qt Creator</a></li>
<li><a href="android-building.html#using-android-studio">Using Android Studio</a></li>
</ul>
<p>Then, you need the following tools:</p>
<ul>
<li>A JDK package such as <a href="https://adoptopenjdk.net/?variant=openjdk8&jvmVariant=hotspot">AdoptOpenJDK</a>, <a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html">JDK</a>, or <a href="http://openjdk.java.net">OpenJDK</a>.</li>
<li><code>CMake</code></li>
<li><code>Ninja</code></li>
</ul>
<h4 id="using-manual-installation">Using Manual Installation</h4>
<p>For more information, see <a href="android-getting-started.html">Getting Started with Qt for Android</a>.</p>
<h4 id="using-qt-creator">Using Qt Creator</h4>
<p>For more information, see <a href="https://doc.qt.io/qtcreator/creator-developing-android.html">Connecting Android Devices</a>.</p>
<h4 id="using-android-studio">Using Android Studio</h4>
<p>You can use <a href="https://developer.android.com/studio#downloads">Android Studio</a> to download and installl the Android SDK packages required for developing applications for Android. For more information, see <a href="https://developer.android.com/studio/intro/update#sdk-manager">Android Studio documentation</a>.</p>
<h2 id="building-qt-for-android">Building Qt for Android</h2>
<p>Qt 6 allows building Qt for Android from source code using <code>CMake</code>. Qt 6 keeps the same configure script from Qt 5. The main difference is that Qt for Android is dependent on a host Qt build, which means to build Qt for Android, you need to build Qt for the desktop platform used as a host (for example Linux, macOS, or Windows).</p>
<p>With the configure script, the same arguments can be used as before. For more information, see <a href="build-sources.html">Building Qt Sources</a>.</p>
<p>Qt for Android supports the following ABIs <i>armeabi-v7a</i>, <i>arm64-v8a</i>, <i>x86</i>, and <i>x86_64</i>.</p>
<div class="admonition note">
<p><b>Note: </b>Qt 6.0 does not support multi-abi feature, for that reason setting the <i>-android-abis</i> is mandatory.</p>
</div>
<h2 id="building-on-linux">Building on Linux</h2>
<p>To build Qt for Android under a Linux environment, follow the steps below:</p>
<h3 id="unpacking-the-archive">Unpacking the Archive</h3>
<p>If you have downloaded the source code archive from <a href="https://www.qt.io/download">Qt Downloads</a>, then unpack the archive if you have not done so already. For example, if you have the <code>qt-everywhere-src-%VERSION%.tar.xz</code> package, type the following commands at a command line prompt:</p>
<pre class="cpp">
 cd <span class="operator">/</span>tmp
 gunzip qt<span class="operator">-</span>everywhere<span class="operator">-</span>opensource<span class="operator">-</span>src<span class="operator">-</span><span class="operator">%</span>VERSION<span class="operator">%</span><span class="operator">.</span>tar<span class="operator">.</span>gz        <span class="preprocessor"># uncompress the archive</span>
 tar xvf qt<span class="operator">-</span>everywhere<span class="operator">-</span>opensource<span class="operator">-</span>src<span class="operator">-</span><span class="operator">%</span>VERSION<span class="operator">%</span><span class="operator">.</span>tar          <span class="preprocessor"># unpack it</span>
</pre>
<p>This creates the directory <code>/tmp/qt-everywhere-src-%VERSION%</code> containing the files from the archive. We only support the GNU version of the tar archiving utility. Note that on some systems it is called gtar.</p>
<p>Otherwise if you cloned the source code from Git, the source will be under <i>qt5</i> folder.</p>
<h3 id="configuring-and-building-on-linux">Configuring and Building on Linux</h3>
<p>Set the following environment variables, and add them to your <code>PATH</code>; preferably at the end of <code>~/.profile</code>:</p>
<pre class="cpp plain">
 export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
 export CMAKE_ROOT=~/Qt/Tools/CMake/bin
 export NINJA_ROOT=~/Qt/Tools/Ninja
 export PATH=$JAVA_HOME/bin:$CMAKE_ROOT:$NINJA_ROOT:$PATH
</pre>
<div class="admonition note">
<p><b>Note: </b>JDK 11 or earlier must be used to properly build Qt for Android.</p>
</div>
<div class="admonition note">
<p><b>Note: </b>We use <a href="http://openjdk.java.net">OpenJDK</a> here, but you can also use other JDK alternatives such as <a href="https://adoptopenjdk.net/?variant=openjdk8&jvmVariant=hotspot">AdoptOpenJDK</a>.</p>
</div>
<p>To configure Qt for Android, create a shadow build directory to keep the source directory clean:</p>
<pre class="cpp plain">
 mkdir &lt;path_to_build_dir&gt;/build-qt
 cd &lt;path_to_build_dir&gt;/build-qt

 &lt;path_to_qt_source&gt;/configure -platform android-clang -prefix &lt;/path/to/install&gt; -android-ndk &lt;path/to/sdk&gt;/ndk/&lt;ndk_version&gt; -android-sdk &lt;path/to/sdk&gt; -qt-host-path &lt;path_to_host_qt_installation&gt; -android-abis arm64-v8a
</pre>
<p><a href="configure-options.html">Qt Configure Options</a> contains more information about the configure options.</p>
<p>You can customize your build configuration in a more advanced manner. For more information, see <a href="android-building.html#advanced-build-arguments">Advanced Build Arguments</a>.</p>
<div class="admonition note">
<p><b>Note: </b>For more information about building Qt 6 with CMake, see <a href="../qtbluetooth/qtbluetooth-index.html#building-with-cmake">Building with CMake</a>.</p>
</div>
<p>To build the configured Qt code, run the following command:</p>
<pre class="cpp plain">
 cmake --build . --parallel
</pre>
<p>Also, the following is possible instead:</p>
<pre class="cpp plain">
 ninja -j$(nproc)
</pre>
<div class="admonition note">
<p><b>Note: </b><i>nproc</i> is optional. It represents the number of parallel jobs your system can do.</p>
</div>
<p>Now, to install Qt, run the following command:</p>
<pre class="cpp plain">
 cmake --install .
</pre>
<p>If you haven't provided the <code>--prefix &lt;install-dir&gt;</code> configure option, the installation is placed under <code>/usr/local/Qt-&lt;version&gt;</code>. In Debian/Ubuntu, you should prefix the <code>make</code> command with the <code>sudo</code> command.</p>
<h2 id="building-on-windows">Building on Windows</h2>
<p>To build Qt for Android under a Windows environment, follow the steps below:</p>
<h3 id="preparing-the-build-environment">Preparing the Build Environment</h3>
<p>In addition to the requirements from <code>Prepare the Build Environment</code>, you need the following on Windows:</p>
<ul>
<li><b>MinGW 7.3</b> toolchain</li>
<li><a href="http://strawberryperl.com">Perl</a></li>
</ul>
<p>Then set the respective environment variables from the <b>Environment Variables</b> system UI, or from the build command line prompt. For the default <code>Command prompt</code>:</p>
<pre class="cpp plain">
 set JDK_ROOT=&lt;JDK_ROOT_PATH&gt;\bin
 set MINGW_ROOT=&lt;MINGW_ROOT_PATH&gt;\bin
 set PERL_ROOT=&lt;PERL_ROOT_PATH&gt;\bin
 set CMAKE_ROOT=C:\Qt\Tools\CMake_64\bin
 set NINJA_ROOT=C:\Qt\Tools\Ninja
 set PATH=%MINGW_ROOT%;%CMAKE_ROOT%;%NINJA_ROOT%;%PERL_ROOT%;%JDK_ROOT%;%PATH%
</pre>
<p>Then, in the command line prompt, verify that:</p>
<pre class="cpp plain">
 where mingw32-make.exe
</pre>
<p>The command should list mingw32-make.exe under the path <i>&lt;MINGW_ROOT&gt;</i> first.</p>
<pre class="cpp plain">
 where javac.exe
</pre>
<p>The command should list javac.exe under the path <i>&lt;JDK_ROOT&gt;</i> first.</p>
<div class="admonition note">
<p><b>Note: </b>JDK 11 or earlier must be used to properly build Qt for Android.</p>
</div>
<div class="admonition note">
<p><b>Note: </b>Qt for Android does not support building with Microsoft Visual C++ (MSVC), we only support building with MinGW.</p>
</div>
<h3 id="configuring-and-building-on-windows">Configuring and Building on Windows</h3>
<p>If you have downloaded the source code archive from <a href="https://www.qt.io/download">Qt Downloads</a>, unpack the archive. Uncompress the files into a temporary folder, for example, <code>C:\Qt\Build\Src_%VERSION%</code>. This path must not contain any spaces or Windows-specific file system characters.</p>
<p>Run the following command to configure Qt:</p>
<pre class="cpp plain">
 mkdir C:\Qt\Build\build-qt
 cd C:\Qt\Build\build-qt

 ..\Src_%VERSION%\configure.bat -platform android-clang -prefix &lt;\path\to\install&gt; -android-sdk &lt;ANDROID_SDK_PATH&gt; -android-ndk &lt;ANDROID_SDK_PATH&gt;\ndk\&lt;ndk_version&gt; -qt-host-path &lt;path_to_host_qt_installation&gt; -android-abis arm64-v8a
</pre>
<p><a href="configure-options.html">Qt Configure Options</a> contains more information about the configure options.</p>
<p>You can customize your build configuration in a more advanced manner. For more information, see <a href="android-building.html#advanced-build-arguments">Advanced Build Arguments</a>.</p>
<div class="admonition note">
<p><b>Note: </b>For more information about building Qt 6 with CMake, see <a href="../qtbluetooth/qtbluetooth-index.html#building-with-cmake">Building with CMake</a>.</p>
</div>
<p>To build the configured Qt for Android code, run the following:</p>
<pre class="cpp plain">
 cmake --build . --parallel
</pre>
<p>Also, the following is possible instead:</p>
<pre class="cpp plain">
 ninja -j&lt;N&gt;
</pre>
<div class="admonition note">
<p><b>Note: </b><i>&lt;N&gt;</i> is optional. It represents the number of parallel jobs your system can do.</p>
</div>
<p>Now, to install Qt, run the following command:</p>
<pre class="cpp plain">
 cmake --install .
</pre>
<h2 id="advanced-build-arguments">Advanced Build Arguments</h2>
<p>Qt for Android contains Java code which is compiled into *.jar files with <i>javac</i>. To set the <i>javac</i> version for source and target, use <i>-android-javac-source</i> and <i>-android-javac-target</i> respectively:</p>
<pre class="cpp plain">
 -android-javac-source 8 -android-javac-target 8
</pre>
<p>To debug Qt with a developer build instead of a prefix build, use the following instead of <code>-prefix</code> argument:</p>
<pre class="cpp plain">
 -developer-build
</pre>
<p>A developer build is meant to be used directly from the build directory.</p>
<div class="admonition note">
<p><b>Note: </b>A developer build takes more storage than a prefix build.</p>
</div>
<h3 id="building-separate-modules">Building Separate Modules</h3>
<p>It is possible to build specific Qt modules only. There are two options:</p>
<ul>
<li>Use the configured <i>qt5</i> build with the following command:<pre class="cpp">
 ninja <span class="operator">-</span>j$(nproc) module<span class="operator">-</span>qtbase
</pre>
<p>The to install those modules, use:</p>
<pre class="cpp">
 ninja <span class="operator">-</span>j$(nproc) module<span class="operator">-</span>qtbase<span class="operator">-</span>install_subtargets
</pre>
</li>
<li>Configure and build <i>qtbase</i> only, then use the resulting <i>qt-configure-module</i> to configure any other module. The only difference is that the configure script in <i>qtbase</i> directory has to be used:<pre class="cpp plain">
 mkdir &lt;path_to_build_dir&gt;/build-qt/qtbase
 cd &lt;path_to_build_dir&gt;/build-qt/qtbase
 &lt;path_to_qt_source&gt;/qtbase/configure [..&#x2e;]
</pre>
<p>Then to configure <code>qtdeclarative</code> for example:</p>
<pre class="cpp plain">
 mkdir &lt;build_directory&gt;/build-qtdeclarative
 cd &lt;build_directory&gt;/build-qtdeclarative
 &lt;qt_for_android_install_path&gt;/bin/qt-configure-module &lt;qt_source_path&gt;/qtdeclarative
 cmake --build . --parallel
 cmake --install .
</pre>
</li>
</ul>
<h2 id="building-user-projects">Building User Projects</h2>
<p>To build CMake projects with the resulting Qt installation, use <code>qt-cmake</code> wrapper. For Android the following has to be be provided:</p>
<pre class="cpp plain">
 &lt;qt_for_android_install_path&gt;/bin/qt-cmake -DANDROID_SDK_ROOT=&lt;android_sdk_path&gt; -DANDROID_NDK_ROOT=&lt;android_ndk_path&gt; -S &lt;source_dir&gt; -B &lt;build_dir&gt;
</pre>
<p>Additionally, you can still use <code>qmake</code> to build user projects, as before in Qt 5.</p>
</div>
<!-- @@@android-building.html -->
<p class="naviNextPrevious footerNavi">
<a class="prevPage" href="android-getting-started.html">Getting Started with Qt for Android</a>
<span class="naviSeparator">  &#9702;  </span>
<a class="nextPage" href="porting-to-android.html">Porting to Android</a>
</p>
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <acronym title="Copyright">&copy;</acronym> 2022 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.<br/>    Qt and respective logos are trademarks of The Qt Company Ltd.     in Finland and/or other countries worldwide. All other trademarks are property
   of their respective owners. </p>
</div>
</body>
</html>
